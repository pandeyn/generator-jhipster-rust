# <%= baseName %>

This application was generated using JHipster <%= jhipsterVersion %> with the Rust blueprint.

## Technology Stack

- **Web Framework**: [Axum](https://github.com/tokio-rs/axum)
<%_ if (devDatabaseTypeMongodb) { _%>
- **Database**: MongoDB with [mongodb](https://docs.rs/mongodb) driver
<%_ } else { _%>
- **ORM**: [Diesel](https://diesel.rs/)
<%_ if (devDatabaseTypePostgresql) { _%>
- **Database**: PostgreSQL
<%_ } else if (devDatabaseTypeMysql) { _%>
- **Database**: MySQL
<%_ } else { _%>
- **Database**: SQLite
<%_ } _%>
<%_ } _%>
- **Runtime**: [Tokio](https://tokio.rs/)
<%_ if (authenticationTypeOauth2) { _%>
- **Authentication**: OAuth2/OIDC with Keycloak
<%_ } else { _%>
- **Authentication**: JWT
<%_ } _%>
<%_ if (serviceDiscoveryConsul) { _%>
- **Service Discovery**: Consul
<%_ } _%>
<%_ if (messageBrokerKafka) { _%>
- **Message Broker**: Apache Kafka
<%_ } _%>
<%_ if (monitoringPrometheus) { _%>
- **Monitoring**: Prometheus metrics
<%_ } _%>

## Development

### Prerequisites

- Rust 1.75 or later
<%_ if (devDatabaseTypePostgresql) { _%>
- PostgreSQL 14 or later
- PostgreSQL client library (`libpq`):
  - macOS: `brew install libpq && echo 'export LIBRARY_PATH="/opt/homebrew/opt/libpq/lib:$LIBRARY_PATH"' >> ~/.zshrc`
  - Ubuntu/Debian: `sudo apt-get install libpq-dev`
  - Fedora: `sudo dnf install libpq-devel`
- Diesel CLI: `cargo install diesel_cli --no-default-features --features postgres`
<%_ } else { _%>
- Diesel CLI: `cargo install diesel_cli --no-default-features --features sqlite`
<%_ } _%>

### Setup

<%_ if (devDatabaseTypePostgresql) { _%>
1. Start PostgreSQL using Docker:
   ```bash
   docker-compose up -d
   ```

2. Run migrations:
   ```bash
   diesel migration run
   ```

3. Start the application:
   ```bash
   cargo run
   ```
<%_ } else { _%>
1. Copy environment file:
   ```bash
   cp .env.example .env
   ```

2. Create database directory:
   ```bash
   mkdir -p target/db
   ```

3. Run migrations:
   ```bash
   diesel migration run
   ```

4. Start the application:
   ```bash
   cargo run
   ```
<%_ } _%>

The server will start at `http://localhost:8080`.

### Available Endpoints

- `GET /api/health` - Health check
- `GET /api/users` - List users (authenticated)
- `GET /api/account` - Get current user account (authenticated)
- `POST /api/authenticate` - Login

## Building for Production

```bash
cargo build --release
```

## Docker

Build and run with Docker:

```bash
docker build -t <%= baseName %> .
docker run -p 8080:8080 <%= baseName %>
```

## Testing

```bash
cargo test
```
<%_ if (devDatabaseTypePostgresql || devDatabaseTypeMysql) { _%>

For database tests, use single-threaded execution to avoid migration conflicts:

```bash
cargo test -- --test-threads=1
```
<%_ } _%>

## CI/CD

Generate CI/CD configuration for your project:

```bash
jhipster-rust ci-cd
```

This supports:

- **GitHub Actions** - `.github/workflows/main.yml`
- **GitLab CI** - `.gitlab-ci.yml`

### Running CI Locally

You can run GitHub Actions locally using [act](https://github.com/nektos/act):

```bash
# Install act (macOS)
brew install act

# Run the workflow
act push --container-architecture linux/amd64
```

See [CI/CD Documentation](docs/CI_CD.md) for more details.

## Project Structure

```
.
├── Cargo.toml              # Workspace manifest
├── diesel.toml             # Diesel configuration
<%_ if (devDatabaseTypePostgresql) { _%>
├── docker-compose.yml      # Docker Compose for PostgreSQL
<%_ } _%>
├── migrations/             # Database migrations
└── server/
    ├── Cargo.toml          # Server crate manifest
    └── src/
        ├── main.rs         # Application entry point
        ├── lib.rs          # Library root
        ├── config/         # Configuration
        ├── db/             # Database connection
        ├── models/         # Diesel models
        ├── handlers/       # Axum route handlers
        ├── services/       # Business logic
        ├── middleware/     # Middleware (auth, etc.)
        ├── errors/         # Error types
        └── dto/            # Data transfer objects
```

## Documentation

Detailed documentation is available in the `docs/` directory:

- [CI/CD Integration](docs/CI_CD.md) - GitHub Actions, GitLab CI, running locally with act
- [Docker Integration](docs/DOCKER.md) - Container configuration and deployment
- [Testing Guide](docs/TESTING.md) - Unit tests, integration tests, and test utilities
- [Security Guide](docs/SECURITY.md) - Authentication, authorization, and security best practices
- [Entity Generation](docs/ENTITY_GENERATION.md) - Adding new entities to your application
<%_ if (enableSwaggerCodegen) { _%>
- [OpenAPI/Swagger](docs/OPENAPI.md) - API documentation and Swagger UI
<%_ } _%>
<%_ if (devDatabaseTypePostgresql) { _%>
- [PostgreSQL Setup](docs/POSTGRES.md) - Database configuration and management
<%_ } else if (devDatabaseTypeMysql) { _%>
- [MySQL Setup](docs/MYSQL.md) - Database configuration and management
<%_ } else if (devDatabaseTypeMongodb) { _%>
- [MongoDB Setup](docs/MONGODB.md) - Database configuration and management
<%_ } else { _%>
- [SQLite Setup](docs/SQLITE.md) - Database configuration and management
<%_ } _%>
<%_ if (authenticationTypeOauth2) { _%>
- [Keycloak Integration](docs/KEYCLOAK.md) - OAuth2/OIDC setup with Keycloak
<%_ } _%>
<%_ if (serviceDiscoveryConsul) { _%>
- [Consul Integration](docs/CONSUL.md) - Service discovery and configuration
<%_ } _%>
<%_ if (messageBrokerKafka) { _%>
- [Kafka Integration](docs/KAFKA.md) - Message broker setup and usage
<%_ } _%>
<%_ if (monitoringPrometheus) { _%>
- [Prometheus Metrics](docs/PROMETHEUS.md) - Monitoring and metrics collection
<%_ } _%>
<%_ if (applicationTypeMicroservice) { _%>
- [Microservices Guide](docs/MICROSERVICES.md) - Microservice architecture and patterns
<%_ } _%>
<%_ if (enableStaticHosting) { _%>
- [Static File Hosting](docs/STATIC_HOSTING.md) - Serving frontend assets
<%_ } _%>
